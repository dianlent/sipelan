"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},7704:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>I,patchFetch:()=>j,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>x});var t={};r.r(t),r.d(t,{POST:()=>m});var a=r(9303),i=r(8716),n=r(670),u=r(7070),o=r(5662),p=r(2023),c=r.n(p),l=r(1482),d=r.n(l);async function m(e){try{let{username:s,email:r,password:t,nama_lengkap:a,role:i="masyarakat"}=await e.json();if(!s||!r||!t||!a)return u.NextResponse.json({success:!1,message:"Semua field harus diisi"},{status:400});if(t.length<6)return u.NextResponse.json({success:!1,message:"Password minimal 6 karakter"},{status:400});let{data:n}=await o.p.from("users").select("id").eq("email",r).single();if(n)return u.NextResponse.json({success:!1,message:"Email sudah terdaftar"},{status:400});let{data:p}=await o.p.from("users").select("id").eq("username",s).single();if(p)return u.NextResponse.json({success:!1,message:"Username sudah digunakan"},{status:400});let l=await c().hash(t,10),{data:m,error:h}=await o.p.from("users").insert([{username:s,email:r,password_hash:l,nama_lengkap:a,role:i}]).select().single();if(h)return console.error("Supabase error:",h),u.NextResponse.json({success:!1,message:"Gagal membuat user"},{status:500});let g=process.env.JWT_SECRET||"default-secret-key-change-in-production",x=d().sign({userId:m.id,email:m.email,role:m.role},g,{expiresIn:"7d"}),{password_hash:f,...I}=m;return u.NextResponse.json({success:!0,message:"User berhasil terdaftar",data:{user:I,token:x}})}catch(e){return console.error("Register API error:",e),u.NextResponse.json({success:!1,message:"Internal server error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"E:\\Dian\\Sistem Informasi Disnaker\\CascadeProjects\\windsurf-project\\sipelan\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:x,serverHooks:f}=h,I="/api/auth/register/route";function j(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:x})}},5662:(e,s,r)=>{r.d(s,{p:()=>n});var t=r(3974);let a="https://pdsfruupgjezqzigncjv.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBkc2ZydXVwZ2plenF6aWduY2p2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3MDU5NzMsImV4cCI6MjA3NzI4MTk3M30.2qjemwRY0Y_D5bw_-RrzxVji6m8Ylo3tJqlRjTC0k7c";if(!a||!i)throw Error("Missing Supabase environment variables");(0,t.eI)(a,i);let n=(0,t.eI)(a,process.env.SUPABASE_SERVICE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var s=require("../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[276,376,944],()=>r(7704));module.exports=t})();