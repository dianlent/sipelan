"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},1309:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>j,patchFetch:()=>f,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>I,staticGenerationAsyncStorage:()=>x});var t={};r.r(t),r.d(t,{POST:()=>m});var a=r(9303),i=r(8716),o=r(670),n=r(7070),u=r(5662),p=r(2023),c=r.n(p),l=r(1482),d=r.n(l);async function m(e){try{let{email:s,password:r}=await e.json();if(!s||!r)return n.NextResponse.json({success:!1,message:"Email dan password harus diisi"},{status:400});let{data:t,error:a}=await u.p.from("users").select("*").eq("email",s).single();if(a||!t)return n.NextResponse.json({success:!1,message:"Email atau password salah"},{status:401});if(!t.is_active)return n.NextResponse.json({success:!1,message:"Akun tidak aktif"},{status:401});if(!await c().compare(r,t.password_hash))return n.NextResponse.json({success:!1,message:"Email atau password salah"},{status:401});let i=process.env.JWT_SECRET||"default-secret-key-change-in-production",o=d().sign({userId:t.id,email:t.email,role:t.role},i,{expiresIn:"7d"}),{password_hash:p,...l}=t;return n.NextResponse.json({success:!0,message:"Login berhasil",data:{user:l,token:o}})}catch(e){return console.error("Login API error:",e),n.NextResponse.json({success:!1,message:"Internal server error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"E:\\Dian\\Sistem Informasi Disnaker\\CascadeProjects\\windsurf-project\\sipelan\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:x,serverHooks:I}=h,j="/api/auth/login/route";function f(){return(0,o.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:x})}},5662:(e,s,r)=>{r.d(s,{p:()=>o});var t=r(3974);let a="https://pdsfruupgjezqzigncjv.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBkc2ZydXVwZ2plenF6aWduY2p2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3MDU5NzMsImV4cCI6MjA3NzI4MTk3M30.2qjemwRY0Y_D5bw_-RrzxVji6m8Ylo3tJqlRjTC0k7c";if(!a||!i)throw Error("Missing Supabase environment variables");(0,t.eI)(a,i);let o=(0,t.eI)(a,process.env.SUPABASE_SERVICE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var s=require("../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[276,376,944],()=>r(1309));module.exports=t})();